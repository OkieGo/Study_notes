# 一、介绍与安装

### 1.1 基本了解

  **Remote Dictionary Server** ( **远程字典服务** )是完全开源的，使用ANSIC语言编写遵守[BSD](https://so.csdn.net/so/search?q=BSD&spm=1001.2101.3001.7020)协议，是一个高性能的Key-Value数据库提供了丰富的数据结构，例如String、Hash、List、Set、SortedSet等等。数据是存在内存中的，同时Redis支持事务、持久化、LUA脚本、发布/订阅、缓存淘汰、流技术等多种功能特性提供了主从模式、Redis Sentinel和Redis Cluster集群架构方案。

### 1.2 功能

* 分布式缓存，挡在mysql数据库之前的一道屏障
* 内存存储和持久化（RDB+AOF），redis支持异步将内存中的数据写到硬盘上，同时不影响继续服务
* 高可用架构搭配
  * 单机
  * 主从
  * 哨兵
  * 集群
* 缓存穿透、击穿、雪崩
* 分布式锁
* 队列
  * Reids提供list和set操作，这使得Redis能作为一个很好的消息队列平台来使用。
  * 我们常通过Reids的队列功能做购买限制。比如到节假日或者推广期间，进行一些活动，对用户购买行为进行限制，限制今天只能购买几次商品或者一段时间内只能购买一次。也比较适合适用。
* 排行榜+点赞
  * 在互联网应用中，有各种各样的排行榜，如电商网站的月度销量排行榜、社交APP的礼物排行榜、小程序的投票排行榜等等。Redis提供的zset数据类型能够快速实现这些复杂的排行榜。比如小说网站对小说进行排名，根据排名，将排名靠前的小说推荐给用户

### 安装

尽量安装在linux中，可以复用linux的多路复用，性能更好。当然windows中也可以安装但不建议。

1. linux中安装gcc环境：`yum -y install gcc- c++`
1. 下载redis并放入linux解压
1. 进入解压目录执行：`make && make install`进行安装。
1. 安装成功后，默认安装在/usr/local/bin/中

### 启动与关闭

启动服务：`redis-server [配置文件路径]`

启动客户端：`redis-cli -a 密码 -p 6379`（默认端口-p为6379）

关闭客户端：`quit`

关闭redis服务：`redis-cli -a 密码 -p 6379 shutdown`（默认端口-p为6379）或者在客户端中：`shutdown`

# 二、数据类型

**redis是k-v键值对进行存储，这里的数据类型是value的数据类型，key的类型都是字符串**

1. String 字符串
2. List 列表
3. Hash 哈希表
4. Set 无序集合
5. Zset 有序集合(Sort set)
6. GEO 地理空间（经纬度）
7. HyperLogLog 基数统计（比如统计有多少不重复用户上线）
8. bitmap 位图
9. bitfield 位域
10. Stream 流

## key操作命令

| 命令                                                      | 描述                                                  |
| :-------------------------------------------------------- | :---------------------------------------------------- |
| [DEL](https://redis.com.cn/commands/del.html)             | 用于阻塞删除 key                                      |
| unlink                                                    | 非阻塞删除key                                         |
| [DUMP](https://redis.com.cn/commands/dump.html)           | 序列化给定 key ，并返回被序列化的值                   |
| [EXISTS](https://redis.com.cn/commands/exists.html)       | 检查给定 key 是否存在                                 |
| [EXPIRE](https://redis.com.cn/commands/expire.html)       | 为给定 key 设置过期时间                               |
| [EXPIREAT](https://redis.com.cn/commands/expireat.html)   | 用于为 key 设置过期时间，接受的时间参数是 UNIX 时间戳 |
| [PEXPIRE](https://redis.com.cn/commands/pexpire.html)     | 设置 key 的过期时间，以毫秒计                         |
| [PEXPIREAT](https://redis.com.cn/commands/pexpireat.html) | 设置 key 过期时间的时间戳(unix timestamp)，以毫秒计   |
| [KEYS](https://redis.com.cn/commands/keys.html)           | 查找所有符合给定模式的 key                            |
| [MOVE](https://redis.com.cn/commands/move.html)           | 将当前数据库的 key 移动到给定的数据库中               |
| [PERSIST](https://redis.com.cn/commands/persist.html)     | 移除 key 的过期时间，key 将持久保持                   |
| [PTTL](https://redis.com.cn/commands/pttl.html)           | 以毫秒为单位返回 key 的剩余的过期时间                 |
| [TTL](https://redis.com.cn/commands/ttl.html)             | 以秒为单位，返回给定 key 的剩余生存时间(              |
| [RANDOMKEY](https://redis.com.cn/commands/randomkey.html) | 从当前数据库中随机返回一个 key                        |
| [RENAME](https://redis.com.cn/commands/rename.html)       | 修改 key 的名称                                       |
| [RENAMENX](https://redis.com.cn/commands/renamenx.html)   | 仅当 newkey 不存在时，将 key 改名为 newkey            |
| [TYPE](https://redis.com.cn/commands/type.html)           | 返回 key 所储存的值的类型                             |

```js
keys *  		//当前库的所有key
exists key      //判断某个key是否存在
type key        //查看你的key是什么类型
del key         //删除指定的key数据
unlink key      //非阻塞删除，仅仅将keys从keyspace元数据中删除，没真正的删除会在后续异步中操作
ttl key         // 查看还有多少秒过期 -1表示永不过期 -2 表示已过期
expire key 秒    // 给key设置过期时间
move key dbindex [0-15]   // 将当前数据库的key移动到指定的数据库中  redis默认是有16个数据库的
select dbindex [0-15]   // 切换数据库[0-15]，默认为0
dbsize   			// 查看当前数据库key的数量
flushdb         		// 清空当前库
flushall 			// 清空16个数据库 慎用

```

**命令不区分大小写，而key的值是区分大小写的**

**help @+数据类型 会出现命令提示 比如 help @string**

## String


* string是redis最基本的类型，一个key对应一个value。
* string类型是二进制安全的，意思是redis的string可以包含任何数据，比如jpg图片或者序列化的对象 。
* string类型是Redis最基本的数据类型，一个redis中字符串value最多可以是512M

![在这里插入图片描述](https://img-blog.csdnimg.cn/59d52ab816114824a740b19aca9fd08d.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/6bf0e2a1bea7458e8add4586d384c82c.png)

**常用的：**

```java
set key value ex 20   // 设置值 20秒过期
get key   // 获得对应的value值
```

同时设置/获取多个键值

```java
MSET [key1] [value1] [key2] [value2] [key3] [value3]  // 同时设置一个或多个键值对
MGET [key1] [key2] [key3]  // 同时获取多个key的值
MSETNX [key1] [value1] [key2] [value2]  // 同时设置一个或多个 key-value 对  必须保证key都不存在才能成功
```

获取指定区间

```java
GETRANGE [key] 0 -1  // 获取这个key的value值
GETRANGE [key] 0 2   // 获取索引0到索引2之间的value值
SETRANGE [key] 1 xxx  // 设置索引1开始的字符串
```

获取字符串长度和内容相加

```java
STRLEN [key]        // 获取key对应的值的长度
APPEND [key] [vale]   // 添加字符串内容
```

数值增减

```java
INCR [key]    // 递增数字 +1
INCRBY [key] [increment]   // 增加指定的整数  +increment 
DECR [key]   // 递减数字 -1
DECRBY [key] [increment]   // 减少指定的整数  -increment 
```

## List
